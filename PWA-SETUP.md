# ICS Dashboard PWA Setup

This document explains how to set up and use the ICS Dashboard as a Progressive Web App (PWA).

## Overview

The ICS Dashboard PWA allows users to:
- Access the full dashboard offline
- Fill out forms offline with auto-save
- Submit forms when back online
- Install the app on their device for easy access
- Use all dashboard features in a native app-like experience

## Architecture

The PWA is the entire ICS Dashboard application with PWA capabilities added.

### Key Components

1. **Main App**: `src/main.tsx` - Full React app with PWA registration
2. **Main HTML**: `index.html` - HTML template with PWA meta tags
3. **PWA Manifest**: `public/pwa-manifest.json` - App configuration
4. **Service Worker**: Auto-generated by Vite PWA plugin
5. **Icons**: PWA icons for different sizes

## Development

### Running the PWA in Development

```bash
# Start development server
npm run dev

# Access PWA at: http://localhost:5173
```

### Building the PWA

```bash
# Build the PWA
npm run build

# Preview the built PWA
npm run preview
```

## Deployment

### 1. Build the PWA

```bash
npm run build
```

### 2. Deploy Files

Deploy the following files to your web server:
- `dist/index.html` (main app)
- `dist/assets/` (all built assets)
- `dist/pwa-manifest.json`
- `dist/sw.js` (service worker)
- `dist/workbox-*.js` (workbox files)

### 3. Server Configuration

Ensure your server serves the PWA files with proper headers:

```nginx
# Nginx configuration
location / {
    try_files $uri $uri/ /index.html;
    
    # PWA headers
    add_header Cache-Control "public, max-age=31536000" for static assets;
    add_header Service-Worker-Allowed "/";
}

# Service worker
location /sw.js {
    add_header Cache-Control "no-cache";
    add_header Service-Worker-Allowed "/";
}
```

## Usage

### For Users

1. **Install the PWA**:
   - Open the dashboard URL in a supported browser
   - Look for "Install" or "Add to Home Screen" option
   - Follow the browser prompts

2. **Use Dashboard Offline**:
   - Access all dashboard features offline
   - Fill out forms with auto-save
   - View analytics and reports (cached data)
   - Submit forms when back online

### For Developers

1. **Access Dashboard**:
   - PWA URL: `https://yourdomain.com/`
   - Form URL: `https://yourdomain.com/fill/{formId}`

2. **Full App Integration**:
   - All dashboard features work offline
   - Form filling with offline support
   - Analytics and reporting capabilities
   - No additional configuration needed

## Features

### Offline Support
- Forms can be filled completely offline
- Drafts are saved to local storage
- Auto-sync when connection is restored

### Caching Strategy
- **Static Assets**: Cached for 1 year
- **API Calls**: Network-first with 1-day cache
- **Images**: Cached for 30 days
- **Fonts**: Cached for 1 year

### Auto-Update
- Service worker automatically updates
- Users are prompted to refresh for new versions
- Graceful fallback for offline scenarios

## Configuration

### PWA Manifest

Edit `public/pwa-manifest.json` to customize:
- App name and description
- Theme colors
- Icons
- Display mode
- Start URL

### Service Worker

The service worker is auto-generated by Vite PWA plugin. To customize:
- Edit `vite.config.ts` PWA configuration
- Modify caching strategies
- Add custom routes

### Icons

Replace placeholder icons with actual ones:
- `public/pwa-icon-192.png` (192x192)
- `public/pwa-icon-512.png` (512x512)
- `public/pwa-icon.svg` (vector icon)

## Browser Support

The PWA works on:
- Chrome/Edge (Android, Windows, macOS)
- Firefox (Android, Windows, macOS)
- Safari (iOS 11.3+, macOS)
- Samsung Internet (Android)

## Troubleshooting

### Common Issues

1. **PWA not installing**:
   - Check HTTPS requirement
   - Verify manifest.json is accessible
   - Ensure service worker is registered

2. **Offline not working**:
   - Check service worker registration
   - Verify caching strategies
   - Test in browser dev tools

3. **Forms not loading**:
   - Check API endpoints
   - Verify CORS settings
   - Test network connectivity

### Debug Tools

- Chrome DevTools > Application > Service Workers
- Chrome DevTools > Application > Manifest
- Chrome DevTools > Network > Offline mode

## Security Considerations

- PWA runs in secure context (HTTPS required)
- Service worker has limited scope
- Local storage is isolated per origin
- API calls respect CORS policies

## Performance

- First load: ~2-3MB (includes all dependencies)
- Subsequent loads: Cached assets
- Offline forms: Instant loading
- Sync: Background processing

## Future Enhancements

- Push notifications for form updates
- Background sync improvements
- Advanced offline conflict resolution
- Multi-form batch operations
